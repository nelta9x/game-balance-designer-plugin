# Pity 시스템 예시

## 1. 선형 Pity (가장 단순)

### 공식
```
P(n) = min(기본확률 + (n-1) × 증가량, 최대확률)
```

### 예시: 강화 시스템

| 실패 횟수 | 확률 (기본 10%, +5%씩) |
|-----------|----------------------|
| 0 (첫 시도) | 10% |
| 1 | 15% |
| 2 | 20% |
| ... | ... |
| 18 | 100% (확정) |

**기대값**: 평균 6.7회 시도

### 장점/단점
- ✅ 이해하기 쉬움
- ✅ 구현 간단
- ❌ 예측 가능해서 긴장감 부족

---

## 2. 소프트 Pity (단계별)

### 원신/스타레일 스타일

```
1~73회:   0.6%
74~89회:  6.0% (소프트 pity, 10배 증가)
90회:     100% (하드 pity)
```

| 구간 | 확률 | 누적 획득 확률 |
|------|------|---------------|
| 1~73회 | 0.6% | ~35% |
| 74회 | 6% | ~38% |
| 80회 | 6% | ~60% |
| 85회 | 6% | ~80% |
| 90회 | 100% | 100% |

**평균**: 약 62회

### 장점/단점
- ✅ 초반 긴장감 유지
- ✅ 후반 보장
- ❌ 구조 복잡

---

## 3. 지수 Pity

### 공식
```
P(n) = min(기본확률 × 배율^(n-1), 최대확률)
```

### 예시: 기본 1%, 배율 1.2

| 시도 | 확률 |
|------|------|
| 1 | 1.0% |
| 5 | 2.1% |
| 10 | 5.2% |
| 15 | 12.8% |
| 20 | 31.9% |
| 25 | 79.5% |
| 27 | 100% |

**특징**: 빠르게 가속

---

## 4. 토큰 축적형

### 메커니즘
```
실패 시: 토큰 +10
성공 시: 토큰 소모
N토큰 도달 시: 확정 보상
```

### 예시

| 시도 | 결과 | 토큰 | 확정까지 |
|------|------|------|---------|
| 1 | 실패 | 10 | 90 |
| 2 | 실패 | 20 | 80 |
| ... | ... | ... | ... |
| 10 | 실패 | 100 | 확정! |

### 변형: 부분 보상
```
50토큰: 중간 보상
100토큰: 최고 보상 확정
```

**장점**: 실패해도 진행 체감

---

## 5. 하드 Pity (확정 횟수)

### 메커니즘
```
N회 시도 시 무조건 성공
```

### 게임별 사례

| 게임 | 최고 등급 | 하드 Pity |
|------|----------|----------|
| 원신 | 5성 | 90회 |
| 스타레일 | 5성 | 90회 |
| 블루아카이브 | 3성 | 200회 |
| 메이플 | 레전드리 | 없음 (!) |

### 설계 고려사항
- 하드 Pity = 과금 유저 예산 상한선
- 너무 낮으면: 수익 감소
- 너무 높으면: 유저 이탈

---

## 6. 중복 보호 (Duplicate Protection)

### 문제
이미 가진 캐릭터/아이템 또 뽑음

### 해결책 1: 중복 시 대체 보상
```
중복 뽑기 → 범용 재화 (스타더스트 등)
```

### 해결책 2: 중복 확률 감소
```
보유 캐릭터 확률 50% 감소
미보유 캐릭터에 재분배
```

### 해결책 3: 선택권
```
일정 횟수 후 원하는 캐릭터 선택 가능
(에픽세븐 천장 시스템)
```

---

## 7. 기대값 계산

### 기본 공식 (Pity 없이)
```
평균 시도 = 1 / 확률
```

1% 확률 → 평균 100회

### Pity 있을 때
시뮬레이션 또는 수식 계산 필요

```python
# 간단 시뮬레이션
def simulate_pity(base_rate, pity_start, pity_rate, hard_pity, trials=100000):
    total = 0
    for _ in range(trials):
        for n in range(1, hard_pity + 1):
            rate = base_rate if n < pity_start else pity_rate
            if random.random() < rate:
                total += n
                break
        else:
            total += hard_pity
    return total / trials
```

---

## 8. 투명성 설계

### 나쁜 예
- 확률 비공개
- Pity 시스템 숨김
- "확률 UP" 구체적 수치 없음

### 좋은 예
- 모든 확률 공개
- 현재 Pity 카운터 표시
- 다음 확정까지 남은 횟수 표시

---

## 설계 체크리스트

1. [ ] 기대값이 플레이어 예산/시간과 맞는가?
2. [ ] 최악의 케이스(하드 Pity)가 수용 가능한가?
3. [ ] Pity 카운터가 UI에 표시되는가?
4. [ ] 배너 간 Pity가 공유/분리되는가?
5. [ ] 확률이 법적 요구사항에 맞게 공개되는가?
